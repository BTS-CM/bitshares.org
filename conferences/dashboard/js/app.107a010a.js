(function(e){function t(t){for(var s,o,i=t[0],c=t[1],u=t[2],d=0,p=[];d<i.length;d++)o=i[d],r[o]&&p.push(r[o][0]),r[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(s=!1)}s&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var s={},r={app:0},a=[];function o(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},"406a":function(e,t,n){"use strict";var s=n("c322"),r=n.n(s);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],o=(n("7c55"),n("2877")),i={},c=Object(o["a"])(i,r,a,!1,null,null,null);c.options.__file="App.vue";var u=c.exports,l=n("8c4f"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Explorer")],1)},p=[],m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stats"},[n("div",{staticClass:"top"},[e._m(0),n("div",{staticClass:"numbers"},[n("table",[n("tr",[e._m(1),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"blockNumber"}},[e._v(e._s(e.blockNo))])])]),n("tr",[e._m(2),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"txNumber"}},[e._v(e._s(e.txs))])])]),n("tr",[e._m(3),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"opNumber"}},[e._v(e._s(e.ops))])])]),n("tr",[e._m(4),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"tx24Number"}},[e._v(e._s(e.txs24))]),e._v(" ("+e._s(e.txs24total)+" total)\n                    ")])]),n("tr",[e._m(5),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"op24Number"}},[e._v(e._s(e.ops24))]),e._v(" ("+e._s(e.ops24total)+" total)\n                    ")])]),n("tr",[e._m(6),n("td",{attrs:{align:"left"}},[n("span",{staticClass:"changed",attrs:{id:"uniqueNumber"}},[e._v(e._s(e.unique))])])])])])]),n("table",{staticClass:"operationList",on:{click:e.toggleUpdates}},e._l(e.reverseOps,function(t){return n("tr",{key:t[2]},[n("td",{style:"text-align:center; width:170px;font-size:12px; font-weight:bold;color:white;background: #"+e.operationReadable(t[0]).color},[e._v(e._s(e.operationReadable(t[0]).name))]),n("td",[n("code",[e._v(e._s(t[1]))])])])}))])},h=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"logo"},[n("img",{attrs:{src:"img/logo.png"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Block No:")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Txs in block:")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Ops in block:")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Txs/s (24h):")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Ops/s (24h):")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td",{attrs:{align:"right"}},[n("label",[e._v("Unique Users (24h):")])])}],f=(n("5df3"),n("4f7f"),n("ac6a"),n("96cf"),n("1da1")),g=n("d4ec"),E=n("bee2"),b=n("99de"),_=n("7e84"),v=n("262e"),A=n("06c1"),T=n("faa1"),F=n.n(T),S=function(e){function t(e){var n;return Object(g["a"])(this,t),n=Object(b["a"])(this,Object(_["a"])(t).call(this)),n.node=e,n}return Object(v["a"])(t,e),Object(E["a"])(t,[{key:"connect",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["Apis"].instance(this.node,!0).init_promise.then(function(e){console.log("connected to:",e[0].network),t.api=A["Apis"].instance();var n=t;t.api.db_api().exec("set_subscribe_callback",[function(e){n.updateListener(e,n)},!1]),t.api.db_api().exec("get_objects",[["2.1.0"]])});case 2:return this.subscription=e.sent,e.abrupt("return",this.subscription);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBlock",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.api.db_api().exec("get_block",[t]));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateListener",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n.emit("block",t);case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),t}(F.a),k=S,R=function(){function e(){Object(g["a"])(this,e),this.items=[]}return Object(E["a"])(e,[{key:"enqueue",value:function(e){this.items.unshift(e)}},{key:"dequeue",value:function(){return this.items.pop()}},{key:"head",value:function(){return this.items[this.items.length-1]}},{key:"tail",value:function(){return this.items[0]}},{key:"isEmpty",value:function(){return 0==this.items.length}},{key:"advanceQueue",value:function(e){this.items.push(e)}},{key:"size",value:function(){return this.items.length}}]),e}(),y=n("f94d"),C=n.n(y),I={name:"Explorer",props:{},data:function(){return{bitshares:{},queue:null,blockNo:"",txs:0,ops:0,txs24:0,ops24:0,txs24total:0,ops24total:0,unique:0,client:null,operations:[],toadd:[],interval:null,stopped:!1,displayops:[]}},computed:{reverseOps:function(){return this.displayops.slice().reverse()}},mounted:function(){var e=this;this.bitshares=new k("wss://bts-seoul.clockwork.gr"),this.bitshares.connect(),this.queue=new R,this.client=new C.a.Client({host:"https://BitShares:Infrastructure@elasticsearch.bitshares.ws"});var t=!1;console.log("es sync"),this.bitshares.on("block",function(){var n=Object(f["a"])(regeneratorRuntime.mark(function n(s){var r,a,o,i,c,u,l,d,p,m,h;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(e.queue.enqueue(e.getDataFromES(s[0][0].head_block_number-2).catch(function(e){console.error("failed",e)})),console.log(s[0][0].head_block_number-2),t&&e.bitshares.getBlock(s[0][0].head_block_number-2).then(function(t){console.log("Block data",t),e.blockNo=s[0][0].head_block_number-2,e.txs=t.transactions.length;var n=0;t.transactions.forEach(function(e){n+=e.operations.length}),e.ops=n}),"pending"==e.queue.head().PromiseStatus){n.next=45;break}return n.next=6,e.queue.dequeue();case 6:if(r=n.sent,r){n.next=9;break}return n.abrupt("return");case 9:for(console.log(r),t||(e.ops=r.responses[0].hits.total),a=new Set,o=[],i=0;i<r.responses[0].hits.hits.length;i++)a.add(r.responses[0].hits.hits[i]._source.block_data.trx_id),o.push([r.responses[0].hits.hits[i]._source.operation_type,r.responses[0].hits.hits[i]._source.operation_history.op_object,r.responses[0].hits.hits[i]._id]);e.txs=a.size,document.getElementById("txNumber").classList.remove("changed"),document.getElementById("opNumber").classList.remove("changed"),document.getElementById("txNumber").offsetWidth,document.getElementById("opNumber").offsetWidth,document.getElementById("txNumber").classList.add("changed"),document.getElementById("opNumber").classList.add("changed"),e.toadd=e.toadd.concat(o),clearInterval(e.interval),e.interval=setInterval(function(){e.toadd.length>0&&(e.operations.push(e.toadd.pop()),e.operations.length>100&&e.operations.shift(),e.stopped||(e.displayops=e.operations.slice()))},3e3/e.ops),t||(e.blockNo=s[0][0].head_block_number-2),document.getElementById("blockNumber").classList.remove("changed"),document.getElementById("blockNumber").offsetWidth,document.getElementById("blockNumber").classList.add("changed"),c=r.responses[1],e.txs24total=(1*c.aggregations["2"].buckets[0]["1"].value).toLocaleString(),u=(1*c.aggregations["2"].buckets[0]["1"].value/86400).toFixed(2),l=!(e.txs24===u),e.txs24=u,d=r.responses[2],e.ops24total=(1*d.aggregations["3"].buckets[0].doc_count).toLocaleString(),u=(1*d.aggregations["3"].buckets[0].doc_count/86400).toFixed(2),p=!(e.ops24===u),e.ops24=u,m=r.responses[3],l&&(document.getElementById("tx24Number").classList.remove("changed"),document.getElementById("tx24Number").offsetWidth,document.getElementById("tx24Number").classList.add("changed")),p&&(document.getElementById("op24Number").classList.remove("changed"),document.getElementById("op24Number").offsetWidth,document.getElementById("op24Number").classList.add("changed")),u=(1*m.aggregations["4"].buckets[0]["1"].value).toLocaleString(),h=!(u===e.unique),e.unique=u,h&&(document.getElementById("uniqueNumber").classList.remove("changed"),document.getElementById("uniqueNumber").offsetWidth,document.getElementById("uniqueNumber").classList.add("changed"));case 45:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}())},methods:{toggleUpdates:function(){this.stopped?this.stopped=!1:this.stopped=!0},getDataFromES:function(e,t){var n=new Date;n.setTime(n.getTime()+1e3);var s=new Date;return s.setTime(s.getTime()-1728e5),this.client.msearch({body:[{},{query:{bool:{filter:{term:{"block_data.block_num":e}}}},size:1e4},{},{aggs:{2:{date_range:{field:"block_data.block_time",ranges:[{from:"now-24h",to:"now"}]},aggs:{1:{cardinality:{field:"block_data.trx_id.keyword"}}}}},size:0,_source:!1,stored_fields:["*"],script_fields:{},query:{bool:{must:[{match_all:{}},{range:{"block_data.block_time":{gte:s.getTime(),lte:n.getTime(),format:"epoch_millis"}}}]}}},{},{aggs:{3:{date_range:{field:"block_data.block_time",ranges:[{from:"now-24h",to:"now"}]}}},size:0,_source:{excludes:[]},stored_fields:["*"],script_fields:{},query:{bool:{must:[{match_all:{}},{range:{"block_data.block_time":{gte:s.getTime(),lte:n.getTime(),format:"epoch_millis"}}}],filter:[],should:[],must_not:[]}}},{},{aggs:{4:{date_range:{field:"block_data.block_time",ranges:[{from:"now-24h",to:"now"}]},aggs:{1:{cardinality:{field:"account_history.account.keyword"}}}}},size:0,_source:{excludes:[]},stored_fields:["*"],script_fields:{},query:{bool:{must:[{match_all:{}},{range:{"block_data.block_time":{gte:s.getTime(),lte:n.getTime(),format:"epoch_millis"}}}],filter:[],should:[],must_not:[]}}}]})},operationReadable:function(e){var t,n;return 0===e?(t="TRANSFER",n="81CA80"):1===e?(t="LIMIT ORDER CREATE",n="6BBCD7"):2===e?(t="LIMIT ORDER CANCEL",n="E9C842"):3===e?(t="CALL ORDER UPDATE",n="E96562"):4===e?(t="FILL ORDER (VIRTUAL)",n="008000"):5===e?(t="ACCOUNT CREATE",n="CCCCCC"):6===e?(t="ACCOUNT UPDATE",n="FF007F"):7===e?(t="ACCOUNT WHIELIST",n="FB8817"):8===e?(t="ACCOUNT UPGRADE",n="552AFF"):9===e?(t="ACCOUNT TRANSFER",n="AA2AFF"):10===e?(t="ASSET CREATE",n="D400FF"):11===e?(t="ASSET UPDATE",n="0000FF"):12===e?(t="ASSET UPDATE BITASSET",n="AA7FFF"):13===e?(t="ASSET UPDATE FEED PRODUCERS",n="2A7FFF"):14===e?(t="ASSET ISSUE",n="7FAAFF"):15===e?(t="ASSET RESERVE",n="55FF7F"):16===e?(t="ASSET FUND FEE POOL",n="55FF7F"):17===e?(t="ASSET SETTLE",n="FFFFAA"):18===e?(t="ASSET GLOBAL SETTLE",n="FFFF7F"):19===e?(t="ASSET PUBLISH FEED",n="FF2A55"):20===e?(t="WITNESS CREATE",n="FFAA7F"):21===e?(t="WITNESS UPDATE",n="F1AA2A"):22===e?(t="PROPOSAL CREATE",n="FFAA55"):23===e?(t="PROPOSAL UPDATE",n="FF7F55"):24===e?(t="PROPOSAL DELETE",n="FF552A"):25===e?(t="WITHDRAW PERMISSION CREATE",n="FF00AA"):26===e?(t="WITHDRAW PERMISSION",n="FF00FF"):27===e?(t="WITHDRAW PERMISSION CLAIM",n="FF0055"):28===e?(t="WITHDRAW PERMISSION DELETE",n="37B68Cc"):29===e?(t="COMMITTEE MEMBER CREATE",n="37B68C"):30===e?(t="COMMITTEE MEMBER UPDATE",n="6712E7"):31===e?(t="COMMITTEE MEMBER UPDATE GLOBAL PARAMETERS",n="B637B6"):32===e?(t="VESTING BALANCE CREATE",n="A5A5A5"):33===e?(t="VESTING BALANCE WITHDRAW",n="696969"):34===e?(t="WORKER CREATE",n="0F0F0F"):35===e?(t="CUSTOM",n="0DB762"):36===e?(t="ASSERT",n="FFFFFF"):37===e?(t="BALANCE CLAIM",n="939314"):38===e?(t="OVERRIDE TRANSFER",n="8D0DB7"):39===e?(t="TRANSFER TO BLIND",n="C4EFC4"):40===e?(t="BLIND TRANSFER",n="F29DF2"):41===e?(t="TRANSFER FROM BLIND",n="9D9DF2"):42===e?(t="ASSET SETTLE CANCEL",n="4ECEF8"):43===e?(t="ASSET CLAIM FEES",n="F8794E"):44===e?(t="FBA DISTRIBUTE",n="8808B2"):(t="UNKOWN",n="8808B2"),{name:t,color:n}}}},O=I,N=(n("406a"),Object(o["a"])(O,m,h,!1,null,"7b313dcc",null));N.options.__file="Explorer.vue";var x=N.exports,L={name:"Home",components:{Explorer:x}},B=L,w=Object(o["a"])(B,d,p,!1,null,null,null);w.options.__file="Home.vue";var D=w.exports;s["a"].use(l["a"]);var P=new l["a"]({routes:[{path:"/",name:"home",component:D}]}),M=n("2f62");s["a"].use(M["a"]);var U=new M["a"].Store({state:{},mutations:{},actions:{}});s["a"].config.productionTip=!1,new s["a"]({router:P,store:U,render:function(e){return e(u)}}).$mount("#app")},"5c48":function(e,t,n){},"7c55":function(e,t,n){"use strict";var s=n("5c48"),r=n.n(s);r.a},c322:function(e,t,n){}});
//# sourceMappingURL=app.107a010a.js.map